<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/dashboard.css}">

    <style>
        /* Dashboard-only polish */
        .topbar {
            display:flex;
            justify-content:space-between;
            align-items:center;
            gap:16px;
            margin-bottom: 18px;
        }
        .topbar .title-wrap h1{
            margin:0;
            font-weight: 800;
            letter-spacing: -0.6px;
        }
        .topbar .subtitle{
            color: rgba(255,255,255,0.78);
            font-size: 0.95rem;
        }
        .actions-right{
            display:flex;
            align-items:center;
            gap:10px;
            flex-wrap: wrap;
        }
        .chip{
            display:inline-flex;
            align-items:center;
            gap:8px;
            padding: 8px 12px;
            border-radius: 999px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.10);
            color: rgba(255,255,255,0.88);
            font-size: 0.9rem;
        }
        .stat-card .stat-label{
            color: rgba(255,255,255,0.72);
            font-size: 0.92rem;
            margin-bottom: 6px;
        }
        .stat-card .stat-value{
            font-size: 2.1rem;
            font-weight: 800;
            letter-spacing: -0.8px;
            margin:0;
        }
        .section-head{
            display:flex;
            justify-content:space-between;
            align-items:center;
            margin-bottom: 12px;
        }
        .section-head h4{
            margin:0;
            font-weight: 800;
            letter-spacing: -0.4px;
        }
        .warehouse-row{
            display:flex;
            justify-content:space-between;
            align-items:center;
            gap:14px;
            padding: 14px 10px;
            border-top: 1px solid rgba(255,255,255,0.10);
        }
        .warehouse-row:first-child{ border-top: 0; padding-top: 6px; }
        .warehouse-name{ font-weight: 700; margin:0; }
        .warehouse-loc{ color: rgba(255,255,255,0.68); font-size: 0.92rem; margin:0; }
        .empty-state{
            color: rgba(255,255,255,0.72);
            padding: 10px 0 0;
        }
    </style>
</head>

<body class="dashboard-page">
<div class="container py-5">

    <!-- TOP BAR (clear hierarchy) -->
    <div class="topbar">
        <div class="title-wrap">
            <h1>Dashboard</h1>
            <div class="subtitle">
                <span th:text="${me.fullName}">User</span>
                <span class="mx-2">•</span>
                <span th:text="${me.personalNumber}">PN</span>

                <span class="mx-2" th:if="${isAdmin}">•</span>
                <span class="chip" th:if="${isAdmin}">ADMIN</span>
            </div>
        </div>

        <div class="actions-right">
            <a class="btn btn-outline-light" th:href="@{/ui/my-transfer-requests}">
                Incoming Transfers
            </a>

            <a class="btn btn-outline-light" th:href="@{/ui/my-signed-items}">
                My Signed Items
            </a>

            <a class="btn btn-primary" th:href="@{/ui/warehouses/new}">+ Create Warehouse</a>

            <a class="btn btn-outline-light" th:if="${isAdmin}" th:href="@{/ui/admin}">Admin</a>

            <form method="post" th:action="@{/ui/logout}" class="m-0">
                <button class="btn btn-outline-danger" type="submit">Logout</button>
            </form>
        </div>
    </div>

    <!-- STATS -->
    <div class="row g-3 mb-4">
        <div class="col-md-6">
            <div class="glass-card stat-card p-4 h-100">
                <div class="stat-label">My Warehouses</div>
                <p class="stat-value" th:text="${#lists.size(myWarehouses)}">0</p>
                <div class="text-muted">Warehouses assigned to your user.</div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="glass-card stat-card p-4 h-100">
                <div class="stat-label">Stock Lines</div>
                <p class="stat-value" th:text="${#lists.size(myStocks)}">0</p>
                <div class="text-muted">Distinct product types in stock.</div>
            </div>
        </div>
    </div>

    <!-- MY WAREHOUSES -->
    <div class="glass-card p-4">
        <div class="section-head">
            <h4>My Warehouses</h4>
            <a class="btn btn-sm btn-outline-light" th:href="@{/ui/warehouses}">View All</a>
        </div>

        <div th:if="${#lists.isEmpty(myWarehouses)}" class="empty-state">
            No warehouses yet. Create one to start managing stock.
        </div>

        <div th:if="${!#lists.isEmpty(myWarehouses)}">
            <div class="warehouse-row" th:each="w : ${myWarehouses}">
                <div>
                    <p class="warehouse-name" th:text="${w.name}">Warehouse</p>
                    <p class="warehouse-loc" th:text="${w.location}">Location</p>
                </div>

                <a class="btn btn-sm btn-outline-light" th:href="@{|/ui/warehouses/${w.id}|}">
                    Open →
                </a>
            </div>
        </div>
    </div>

</div>
</body>
</html>
